
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:a="http://richfaces.org/a"
	xmlns:mj="http://mojarra.dev.java.net/mojarra_ext"
	template="/WEB-INF/templates/template-seguridad.xhtml">

	<ui:define name="security">
		<h:body
			onload="#{loginController.permisoValidado('USUARIOS')}">
		</h:body>
	</ui:define>
	
	<ui:define name="head">
		<title>Gestion de Usuarios</title>
	</ui:define>

	<ui:define name="header">

		<div class="row">
			<div class="col-sm-12 col-md-12" align="left">

				<ol class="breadcrumb">
					<li class="fuente-link-sidebar">
						<div class="lsf symbol">sitemap</div>
					</li>

					<li class="fuente-link-sidebar"><a href="/buffalo/">
							Inicio </a></li>
					<li class="fuente-link-sidebar"><a
						href="/buffalo/pages/parametrizacion/home.xhtml"> Config. del
							Sistema</a></li>
					<li class="active" style="color: orange;"><a
						class="fuente-link-sidebar" style="color: orange;"
						href="/buffalo/pages/administracion/register-usuario.xhtml">Gestion
							de Usuarios</a></li>
				</ol>
			</div>
		</div>

	</ui:define>

	<ui:define name="content">
		<h:form id="formRegistroUsuario" styleClass="form-horizontal">

			<div class="row">
				<div class="col-sm-4 col-md-3" align="left">

					<div class="panel panel-primary">
						<div class="panel-heading">
							<h3 class="panel-title">
								<strong> <span class="glyphicon glyphicon-user" />
									#{usuarioController.tituloPanel.toUpperCase()}
								</strong>
							</h3>
						</div>
						<div class="panel-body">

							<h:panelGrid columns="2">
								<h:outputLabel for="name" value="Nombre" />
								<p:inputText id="name"
									value="#{usuarioController.newUsuario.name}"
									styleClass="form-control" required="true"
									requiredMessage="Requerido.">
									<p:ajax event="change" update="name" />
								</p:inputText>


								<h:outputLabel for="direccionID" value="Direccion" />
								<p:inputText id="direccionID"
									value="#{usuarioController.newUsuario.direccion}"
									styleClass="form-control" required="true"
									requiredMessage="Requerido.">
									<p:ajax event="change" update="direccionID" />
								</p:inputText>


								<h:outputLabel for="ubicacionID" value="Barrio/Ubicacion" />
								<p:inputText id="ubicacionID"
									value="#{usuarioController.newUsuario.barrrioUbicacion}"
									styleClass="form-control" required="true"
									requiredMessage="Requerido.">
									<p:ajax event="change" update="ubicacionID" />
								</p:inputText>


								<h:outputLabel for="documentoID" value="Nro Documento" />
								<p:inputText id="documentoID"
									value="#{usuarioController.newUsuario.numeroDocumento}"
									styleClass="form-control" required="false"
									requiredMessage="Requerido.">
								</p:inputText>


								<h:outputLabel for="telefonoID" value="No. Telefono" />
								<p:inputText id="telefonoID"
									value="#{usuarioController.newUsuario.telefono}"
									styleClass="form-control" required="false"
									requiredMessage="Requerido.">
								</p:inputText>


								<h:outputLabel for="celularID" value="No. Celular" />
								<p:inputText id="celularID"
									value="#{usuarioController.newUsuario.celular}"
									styleClass="form-control" required="true"
									requiredMessage="Requerido.">
									<p:ajax event="change" update="celularID" />
								</p:inputText>


								<h:outputLabel for="referenciaID" value="Telf. Referencia" />
								<p:inputText id="referenciaID"
									value="#{usuarioController.newUsuario.telefonoReferencia}"
									styleClass="form-control" required="false"
									requiredMessage="Requerido.">
								</p:inputText>



								<h:outputLabel for="email" value="Email" />
								<p:inputText id="email"
									value="#{usuarioController.newUsuario.email}"
									styleClass="form-control" required="true"
									requiredMessage="Requerido.">
									<p:ajax event="change" update="email" />
								</p:inputText>


								<h:outputLabel for="sucursal" value="Sucursal" />
								<h:selectOneMenu id="sucursal"
									value="#{usuarioController.newUsuario.sucursal.id}"
									styleClass="form-control" effect="fade" required="true"
									requiredMessage="Requerido.">
									<f:selectItem itemValue="" itemLabel="-- Seleccione --" />
									<f:selectItems value="#{sucursalesActivas}" var="_sucursales"
										itemLabel="#{_sucursales.nombre}"
										itemValue="#{_sucursales.id}" />
									<p:ajax event="change" update="almacen"
										listener="#{usuarioController.sucursalSeleccionada()}" />
								</h:selectOneMenu>

								<h:outputLabel for="almacen" value="Almacen" />
								<h:selectOneMenu id="almacen"
									value="#{usuarioController.newUsuario.almacen.id}"
									styleClass="form-control" effect="fade">
									<f:selectItem itemValue="" itemLabel="-- Seleccione --" />
									<f:selectItems value="#{usuarioController.listaAlmacen}"
										var="_almacen" itemLabel="#{_almacen.nombre}"
										itemValue="#{_almacen.id}" />
									<p:ajax event="change" update="almacen"
										listener="#{usuarioController.almacenSeleccionado()}" />
								</h:selectOneMenu>

								<h:outputLabel for="cargoID" value="Cargo" />
								<h:selectOneMenu id="cargoID"
									value="#{usuarioController.newUsuario.cargo.id}"
									styleClass="form-control" effect="fade" required="true"
									requiredMessage="Requerido.">
									<f:selectItem itemValue="" itemLabel="-- Seleccione --" />
									<f:selectItems value="#{usuarioController.listaCargos}"
										var="_var" itemLabel="#{_var.nombre}" itemValue="#{_var.id}" />
									<p:ajax event="change" update="cargoID" />
								</h:selectOneMenu>


								<h:outputLabel value="Estado" for="estadoID" />
								<h:selectOneMenu id="estadoID"
									value="#{usuarioController.newUsuario.estado}"
									styleClass="form-control" required="true"
									requiredMessage="Estado Requerido.">
									<f:selectItem itemValue="AC" itemLabel="Activo" />
									<f:selectItem itemValue="IN" itemLabel="Inactivo" />
									<p:ajax event="change" update="estadoID" />
								</h:selectOneMenu>

								<h:outputLabel value="Fecha Registro" for="fechaRegistroID" />
								<p:calendar id="fechaRegistroID" showOn="button"
									value="#{usuarioController.newUsuario.fechaRegistro}"
									pattern="dd/MM/yyyy" disabled="true" required="true"
									requiredMessage="Requerido." />

								<h:outputLabel value="Registro" for="usuarioRegistroID" />
								<p:inputText id="usuarioRegistroID" styleClass="form-control"
									value="#{usuarioController.newUsuario.usuarioRegistro}"
									disabled="true" required="true" requiredMessage="Requerido." />

							</h:panelGrid>

						</div>

						<div class="panel-footer" style="padding: 1px 1px 1px 1px;">
							<div class="btn-group btn-group-sm" style="width: 100%;">


								<p:commandButton
									rendered="#{usuarioController.modificar=='true'}"
									icon="ui-icon-minus"
									action="#{usuarioController.initNewUsuario()}"
									style="width: 33%;" update=":formRegistroUsuario"
									styleClass="btn btn-default" value="Cancelar" type="submit" />

								<p:commandButton
									rendered="#{usuarioController.modificar=='false'}"
									icon="ui-icon-disk"
									action="#{usuarioController.registrarUsuario()}"
									style="width: 100%;" update=":formRegistroUsuario, :growl"
									styleClass="btn btn-success" value="Registrar Personal"
									type="submit" />

								<p:commandButton
									rendered="#{usuarioController.modificar=='true'}"
									icon="ui-icon-refresh"
									action="#{usuarioController.modificarUsuario()}"
									style="width: 33%;" update=":formRegistroUsuario, :growl"
									styleClass="btn btn-primary" value="Modificar" type="submit" />

								<p:commandButton
									rendered="#{usuarioController.modificar=='true'}"
									icon="ui-icon-circle-close"
									action="#{usuarioController.eliminarUsuario()}"
									style="width: 33%;" update=":formRegistroUsuario, :growl"
									styleClass="btn btn-danger" value="Borrar" type="submit" />

							</div>
						</div>


					</div>


				</div>


				<div class="col-sm-4 col-md-9" align="left">
					<div class="row">





						<div class="col-sm-3 col-md-3" align="left">
							<div class="panel panel-default">
								<!-- Default panel contents -->
								<div class="panel-heading">
									<h3 class="panel-title">
										<strong> <span class="glyphicon glyphicon-pencil" />
											INGRESO AL SISTEMA
										</strong>
									</h3>
								</div>
								<div class="panel-body">
									<h:panelGrid columns="2">

										<p:outputLabel for="accesoID" value="Permitir" />
										<p:selectBooleanCheckbox id="accesoID"
											value="#{usuarioController.newUsuario.ingresoSistema}"
											required="true" requiredMessage="Requerido.">
											<p:ajax event="change" update=":formRegistroUsuario" />
										</p:selectBooleanCheckbox>

										<p:outputLabel for="login" value="Login" />
										<p:inputText id="login"
											disabled="#{usuarioController.newUsuario.ingresoSistema=='false'}"
											value="#{usuarioController.newUsuario.login}"
											styleClass="form-control"
											required="#{usuarioController.newUsuario.ingresoSistema}"
											requiredMessage="Requerido.">
											<p:ajax event="change" update="login" />
										</p:inputText>

										<p:outputLabel for="password" value="Password" />
										<p:inputText type="password" id="password"
											disabled="#{usuarioController.newUsuario.ingresoSistema=='false'}"
											value="#{usuarioController.newUsuario.password}"
											styleClass="form-control"
											required="#{usuarioController.newUsuario.ingresoSistema}"
											requiredMessage="Requerido.">
											<p:ajax event="change" update="password" />
										</p:inputText>

										<p:outputLabel value="Rol" />
										<h:selectOneMenu id="rol"
											value="#{usuarioController.selectedRoles.id}"
											disabled="#{usuarioController.newUsuario.ingresoSistema=='false'}"
											styleClass="form-control" effect="fade">
											<f:selectItems value="#{usuarioController.listRoles}"
												var="roles" itemLabel="#{roles.name}"
												itemValue="#{roles.id}" />
											<p:ajax event="change" update=":formRegistroUsuario" />
										</h:selectOneMenu>

									</h:panelGrid>
								</div>
							</div>
						</div>



						<div class="col-sm-3 col-md-3" align="left">
							<div class="panel panel-default">
								<!-- Default panel contents -->
								<div class="panel-heading">
									<h3 class="panel-title">
										<strong> <span class="glyphicon glyphicon-pencil" />
											FOTOGRAFIA
										</strong>
									</h3>
								</div>
								<div class="panel-body">

									<div class="thumbnail">
										<div class="media">
											<div class="media-left">
												<center>
													<img
														src="#{perfilController.URLServletImage}/ServletImageUserParam?email=#{usuarioController.selectedUsuario.email}"
														class="thumbnail" width="100px;" height="100px;" />
												</center>
											</div>
											<div class="media-body">
												<p:commandButton value="Cambiar" rendered="false" />
											</div>
										</div>
									</div>

								</div>
							</div>
						</div>
						<div class="col-sm-6 col-md-6" align="left"></div>

					</div>





					<div class="panel panel-default">
						<!-- Default panel contents -->
						<div class="panel-heading">
							<h3 class="panel-title">
								<strong> <span class="glyphicon glyphicon-th-list" />
									LISTA DEL PERSONAL REGISTRADO
								</strong>
							</h3>
						</div>

						<!-- Table -->
						<div class="table-responsive">

							<p:dataTable
								styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
								selection="#{usuarioController.selectedUsuario}"
								selectionMode="single" rowKey="#{_usuario.id}"
								id="usuariosTable" var="_usuario" value="#{usuarios}"
								emptyMessage="No se encontraron registros.">

								<p:ajax event="rowSelect" update=":formRegistroUsuario"
									listener="#{usuarioController.onRowSelectUsuarioClick}" />


								<p:column id="usuario_id" filterBy="#{_usuario.id}"
									filterStyle="width: 100%;" filterMatchMode="contains">
									<f:facet name="header">ID</f:facet>
									<center>
										<span class="badge">#{_usuario.id}</span>
									</center>
								</p:column>

								<p:column id="usuario_nombre" filterBy="#{_usuario.name}"
									filterStyle="width: 100%;" filterMatchMode="contains">
									<f:facet name="header">Nombre Completo</f:facet>
									<h:graphicImage value="/resources/icons/user2.png" width="15px"
										height="15px" />
					                      		#{_usuario.name}
					                   </p:column>

								<p:column id="usuario_login" filterBy="#{_usuario.login}"
									filterStyle="width: 100%;" filterMatchMode="contains">
									<f:facet name="header">Login</f:facet>
									<h:graphicImage value="/resources/icons/key2.png" width="20px"
										height="20px" rendered="#{_usuario.ingresoSistema=='true'}" />
					                      		#{'  '}
					                      		<h:outputText value="#{_usuario.login}"
										rendered="#{_usuario.ingresoSistema=='true'}" />

									<ui:fragment rendered="#{_usuario.ingresoSistema=='false'}">
										<span class="glyphicon glyphicon-ban-circle" />
					                      		#{'  '}
					                      		<h:outputText value="Sin Acceso"
											rendered="#{_usuario.ingresoSistema=='false'}" />
									</ui:fragment>
								</p:column>

								<p:column id="cargo_personal"
									filterBy="#{_usuario.cargo.nombre}" filterStyle="width: 100%;"
									filterMatchMode="contains">
									<f:facet name="header">Cargo</f:facet>
					                      		#{_usuario.cargo.nombre}
					                   </p:column>

								<!-- 
										
					
											<p:column id="usuario_email">
												<f:facet name="header">Email</f:facet>
					                      #{_usuario.email}
					                   </p:column> -->

								<p:column id="usuario_sucursal"
									filterBy="#{_usuario.sucursal.nombre}"
									filterStyle="width: 100%;" filterMatchMode="contains">
									<f:facet name="header">Sucursal</f:facet>
									<h:graphicImage value="/resources/icons/home.png" width="20px"
										height="20px" />
									<span class="badge">#{_usuario.sucursal.nombre}</span>
								</p:column>
								<!-- 
											<p:column id="usuario_roles">
												<f:facet name="header">Roles</f:facet>
					                      #{'Roles: '}
					                      <ui:repeat var="_rol"
													value="#{usuarioController.listarRoles(_usuario.email)}">
													<lu> <span class="badge">#{_rol.roles.name}</span>
													<h:outputText value=" | "
													rendered="#{_rol.roles.name=='security-role'}" /> </lu>
											</ui:repeat>
										</p:column> -->

								<p:column headerText="Estado" filterBy="#{_usuario.estado}"
									filterStyle="width: 100%;" filterMatchMode="contains">
									<span class="label label-success"><h:outputText
											rendered="#{_usuario.estado=='AC'}" value="Activo" /></span>
									<span class="label label-danger"><h:outputText
											rendered="#{_usuario.estado=='IN'}" value="Inactivo" /></span>
								</p:column>
								<p:column headerText="Fecha"
									filterBy="#{_usuario.fechaRegistro}" filterStyle="width: 100%;"
									filterMatchMode="contains">
									<h:outputText value="#{_usuario.fechaRegistro}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputText>
								</p:column>
								<p:column headerText="Registro"
									filterBy="#{_usuario.usuarioRegistro}"
									filterStyle="width: 100%;" filterMatchMode="contains">
									<h:outputText value="#{_usuario.usuarioRegistro}" />
								</p:column>

							</p:dataTable>


						</div>
					</div>

				</div>



			</div>




		</h:form>

	</ui:define>

	<ui:define name="footer">

	</ui:define>

</ui:composition>