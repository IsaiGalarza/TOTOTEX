
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:a="http://richfaces.org/a"
	xmlns:mj="http://mojarra.dev.java.net/mojarra_ext"
	template="/WEB-INF/templates/templateModuloCompras.xhtml">


	<ui:define name="security">
		<h:body
			onload="#{loginController.permisoValidado('ORDEN DE COMPRA')}">
		</h:body>
	</ui:define>
	
	<ui:define name="head">
		<title>Ordenes de Compra Tototex</title>
	</ui:define>

	<ui:define name="header">

	</ui:define>

	<ui:define name="content">

		<ol class="breadcrumb">
			<li class="fuente-link-sidebar">
				<div class="lsf symbol">sitemap</div>
			</li>

			<li class="fuente-link-sidebar"><a href="/buffalo/"> Inicio
			</a></li>
			<li class="active" style="color: orange;"><a class="fuente-link-sidebar"
				style="color: orange;" href="/buffalo/pages/compra/home.xhtml">Modulo
					Compra</a></li>

		</ol>


		<div class="row">
			<h:form id="formRegistroPedidoMov" styleClass="form-horizontal">
				<div class="col-sm-12 col-md-12" align="left">

					<div class="tabbable tabs-left">
						<ul class="nav nav-tabs span2">
							<li class="#{ordenCompraController.activePendientes}"><a href="#tabs5-pane1" data-toggle="tab"><STRONG>Ordenes de Compra Pendientes</STRONG></a></li>
							<li class="#{ordenCompraController.activeProcesadas}"><a href="#tabs5-pane2" data-toggle="tab" ><STRONG>Ordenes Procesadas</STRONG></a></li>
							<li class="#{ordenCompraController.activeAnuladas}"><a href="#tabs5-pane3" data-toggle="tab"><STRONG>Ordenes Anuladas</STRONG></a></li>
							<li class="#{ordenCompraController.activeTodas}"><a href="#tabs5-pane4" data-toggle="tab"><STRONG>Todas Las Ordenes</STRONG></a></li>
						</ul>
						
						<div class="tab-content span5">
							<div id="tabs5-pane1" class="tab-pane #{ordenCompraController.activePendientes}">
								
								<ui:fragment rendered="#{ordenCompraController.nuevo=='true' or ordenCompraController.modificar=='true' }" id="fragmentNuevo">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h3 class="panel-title">
												<strong>#{ordenCompraController.tituloPanel}</strong>
											</h3>
										</div>
										<div class="panel-body">
											<div class="row">
												<div class="col-sm-4 col-md-3" align="center">
													<div class="panel panel-primary">
														<div class="panel-heading">
															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>Datos de la Orden de Compra</strong>
															</h3>
														</div>

														<h:panelGrid columns="3">

															<h:outputLabel value="Orden Compra" for="ordenID"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />
															<p:inputText id="ordenID" styleClass="form-control"
																size="30" disabled="true"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}"
																value="OC-#{ordenCompraController.newOrdenCompra.id}">
															</p:inputText>
															<p:message for="ordenID"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />

															<h:outputLabel for="almacenIID" value="Almacen" />
															<h:selectOneMenu id="almacenIID"
																value="#{ordenCompraController.newOrdenCompra.almacen.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un Almacen!"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va"
																	value="#{ordenCompraController.listAlmacen}"
																	itemValue="#{va.id}" itemLabel="#{va.nombre}" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="almacenIID" />

															<h:outputLabel value="Proveedor:" for="proveedorID" />
															<h:selectOneMenu id="proveedorID"
																value="#{ordenCompraController.newOrdenCompra.proveedor.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un proveedor!"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va" value="#{ordenCompraController.listProveedor}"
																	 itemLabel="#{va.nombre}" itemValue="#{va.id}"/>
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="proveedorID" />
															
															<h:outputLabel value="Concepto" for="descripcionID" />
															<p:inputText id="descripcionID" styleClass="form-control"
																size="30"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
																value="#{ordenCompraController.newOrdenCompra.observacion}">
																<p:ajax event="change" />
															</p:inputText>
															<p:message for="descripcionID" />

															<h:outputLabel for="documentoID" value="Tipo_Documento" />
															<h:selectOneMenu id="documentoID"
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Requerido."
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}">
																<f:selectItem itemValue="NA" itemLabel="Sin Documento" />
																<f:selectItem itemValue="FACTURA" itemLabel="Factura" />
																<f:selectItem itemValue="PROFORMA" itemLabel="Proforma" />
																<f:selectItem itemValue="RECIBO" itemLabel="Recibo" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="documentoID" />                                                             
                                                            
															<h:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															<p:inputText id="facturaID" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
																<f:validateRegex pattern="[0-9 ]*" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</p:inputText>
															<p:message for="facturaID" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>															
															
															
															<h:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>
															<p:inputText id="conceptoID" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
																size="30" required="true" requiredMessage="Por Favor, Introduzca una descripcion a NA.!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
															
															</p:inputText>
															<p:message for="conceptoID" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>
															

															<h:outputLabel value="Descuento" for="desUNOGID" />
															<p:inputText id="desUNOGID" styleClass="form-control"
																size="30" converter="converterPorcentaje"
																value="#{ordenCompraController.newOrdenCompra.totalDescuento}"
																required="true" requiredMessage="Requerido.">
																<f:validateDoubleRange minimum="0" maximum="100"></f:validateDoubleRange>
																<p:ajax event="change" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
																
															</p:inputText>
															<p:message for="desUNOGID" />														
															
															
															<h:outputLabel value="Total Bs" for="totalBSID" />
															<p:inputText id="totalBSID" styleClass="form-control"
																disabled="true" size="30"
																value="#{ordenCompraController.newOrdenCompra.totalImporte}"
																required="true" requiredMessage="Requerido.">
																<p:ajax event="change" />
																<f:convertNumber pattern="#,##0.000"  locale="en" />
															</p:inputText>
															<p:message for="totalBSID" />

															<h:outputLabel value="Fecha_Registro"
																for="fechaRegistroID" />
															<p:inputText id="fechaRegistroID"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.fechaRegistro}"
																disabled="true" required="true"
																requiredMessage="Requerido.">
																<f:convertDateTime pattern="dd/MM/yyyy" />
															</p:inputText>
															<p:message for="fechaRegistroID" />

															<h:outputLabel value="Registro" for="usuarioRegistroID" />
															<p:inputText id="usuarioRegistroID"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.usuarioRegistro}"
																disabled="true" required="true"
																requiredMessage="Usuario Registro Requerido." />
															<p:message for="usuarioRegistroID" />
															

														</h:panelGrid>
													</div>
												</div>
												<div class="col-sm-5 col-md-9" align="left">
													<div class="panel panel-success">
														<div class="panel-heading">

															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>LISTA DE DETALLE</strong>
															</h3>
														</div>

														<div class="panel panel-default">
															<div class="table-responsive">

																<p:dataTable
																	styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
																	selection="#{ordenCompraController.selectedDetalleOC}"
																	selectionMode="single" rowKey="#{_det}"
																	id="detalleTableID" var="_det"
																	emptyMessage="No se encontraron registros."
																	value="#{ordenCompraController.listaDetalleOC}">
																	<p:ajax event="rowSelect"
																		update=":formRegistroPedidoMov"
																		listener="#{ordenCompraController.onRowSelectDetalleClick}" />


																	<p:column headerText="Nombre">
																		<p:outputLabel value="#{_det.producto.nombreProducto}" />
																	</p:column>

																	<p:column headerText="Cantidad">

																		<h:outputText value="#{_det.cantidad}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																		<p:outputLabel value="Uds." />
																	</p:column>
																	<p:column headerText="Precio Unitario">
																		<h:outputText value="#{_det.precioUnitario}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>																	
																																		
																	<p:column headerText="Total BS">
																		<h:outputText value="#{_det.total}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>
																	
																	<p:columnGroup type="footer">
																		<p:row>
																			<p:column footerText="Totals: " colspan="5"
																				style="text-align:right" />
																			<p:column>
																				<f:facet name="footer">
																					<h:outputText value="#{ordenCompraController.newOrdenCompra.totalImporte}">
																						<f:convertNumber pattern="#,##0.000"  locale="en" />
																					</h:outputText>
																				</f:facet>
																			</p:column>																			
																			
																		</p:row>
																	</p:columnGroup>

																</p:dataTable>

															</div>

														</div>
														<div class="panel-footer" align="right">
															<p:commandButton value="Agregarss" id="agregarID2"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
																icon="ui-icon-plus"
																style="width: 90px;"
																styleClass="btn btn-success btn-right"
																update=":formModalDetalleD" immediate="true"
																actionListener="#{ordenCompraController.listarProducto()}" />

															<p:commandButton id="quitarCompuestoID2" value="Quitar"
																update=":formRegistroPedidoMov"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
																actionListener="#{ordenCompraController.eliminarDetalleOrdenCompra()}"
																icon="ui-icon-trash"
																style="width: 90px; text-color: white;"
																styleClass="btn btn-danger" immediate="true" />
														</div>
													</div>


												</div>
											</div>
										</div>


									</div>
									
									<div class="btn-group btn-group-sm" style="width: 100%;">
	
										<p:commandButton
											rendered="#{ordenCompraController.modificar=='true' or ordenCompraController.nuevo=='true'}"
											icon="ui-icon-minus"
											action="#{ordenCompraController.initNewOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-default btn-md" value="Cancelar"
											type="submit" immediate="true" />
	
										<p:commandButton
											rendered="#{ordenCompraController.modificar=='false' and ordenCompraController.nuevo=='true'}"
											action="#{ordenCompraController.registrarOrdenCompra()}"
											icon="ui-icon-disk" update=":formRegistroPedidoMov"
											style="width: 8em;" styleClass="btn btn-primary"
											value="Guardar" type="submit" />
	
										<p:commandButton
											rendered="#{ordenCompraController.modificar=='true'}"
											icon="ui-icon-refresh"
											action="#{ordenCompraController.modificarOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-primary btn-md" value="Modificar"
											type="submit" />
	
										<p:commandButton
											rendered="#{ordenCompraController.modificar=='true'}"
											icon="ui-icon-circle-close"
											disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
											action="#{ordenCompraController.procesarOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-info btn-md" value="Procesar"
											type="submit" />
	
										<p:commandButton
											rendered="#{ordenCompraController.modificar=='true'}"
											icon="ui-icon-circle-close"
											disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
											action="#{ordenCompraController.eliminarOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-danger btn-md" value="Anular"
											type="submit" />	
	
	
										<p:commandButton value="Ver PDF"
											styleClass="btn btn-success btn-md"
											rendered="#{ordenCompraController.modificar=='true'}" update=":formModalVistaPrevia" oncomplete="PF('dlgVistaPrevia').show()"
											style="width: 16em;" icon="ui-icon-document">
										</p:commandButton>
	
									</div>									
								
								</ui:fragment>
								
								<div class="btn-group btn-group-sm" style="width: 100%;">
									<p:commandButton
												rendered="#{ordenCompraController.modificar=='false' and ordenCompraController.nuevo=='false'}"
												action="#{ordenCompraController.crearOrdenCompra()}"
												icon="ui-icon-disk" update=":formRegistroPedidoMov"
												style="width: 8em;" styleClass="btn btn-success btn-md"
												value="Crear" type="submit" />
								</div>				
								
								<ui:fragment
									rendered="#{ordenCompraController.nuevo=='false' and ordenCompraController.modificar=='false' }">
									<div id="newOrdenComprasMessages" class="update" />

									<h:panelGroup rendered="#{empty ordenCompraController.listaOrdenCompra}">
										<em>No se encontraron registros.</em>
									</h:panelGroup>

									<div class="panel panel-default">
										<!-- Default panel contents -->
										<div class="panel-heading">
											<center>
												<strong>LISTA DE ORDENES PENDIENTES</strong>
											</center>
										</div>

										<!-- Table -->
										<div class="table-responsive">

											<p:dataTable
												styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
												selection="#{ordenCompraController.selectedOrdenCompra}"
												selectionMode="single" rowKey="#{_pedido.id}"
												id="pedidoTable" var="_pedido" value="#{ordenCompraController.listaOrdenCompra}"
												rendered="#{not empty ordenCompraController.listaOrdenCompra}">

												<p:ajax event="rowSelect" update=":formRegistroPedidoMov"
													listener="#{ordenCompraController.onRowSelectPedidoMovClick}" />

												<p:column headerText="ID" width="50">
													<span class="label label-success">OC-#{_pedido.id}</span>
												</p:column>
												<p:column headerText="Descripcion"
													filterBy="#{_pedido.observacion}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.observacion}" />
												</p:column>
												
												<p:column headerText="Almacén">
														<h:outputText value="#{_pedido.almacen.nombre}" />
												</p:column>
												
												<p:column headerText="Fecha" width="100"
													filterBy="#{_pedido.fechaRegistro}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.fechaRegistro}">
														<f:convertDateTime pattern="dd/MM/yyyy" />
													</h:outputText>
												</p:column>

												<p:column headerText="Usuario"
													filterBy="#{_pedido.usuarioRegistro}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.usuarioRegistro}" />
												</p:column>
												<p:column headerText="Total Bs." filterBy="#{_pedido.total}" width="100"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.totalImporte}" >
														<f:convertNumber pattern="#,##0.000"  locale="en" />
													</h:outputText>
												</p:column>
												
												<p:column headerText="Estado" width="100">
													<span class="label label-success"><h:outputText
															rendered="#{_pedido.estado=='AC'}" value="Nuevo" /></span>
													<span class="label label-primary"><h:outputText
															rendered="#{_pedido.estado=='PR'}" value="Aprobado" /></span>
													<span class="label label-danger"><h:outputText
															rendered="#{_pedido.estado=='RM'}" value="Anulado" /></span>
												</p:column>
											</p:dataTable>

										</div>
									</div>
								</ui:fragment>

							</div>
							
							<div id="tabs5-pane2" class="tab-pane #{ordenCompraController.activeProcesadas}">
							
								<ui:fragment id="fragmentProcesarDetalleProcesadas" rendered="#{ordenCompraController.estadoDetalleProcesar}">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h3 class="panel-title">
												<strong>#{ordenCompraController.tituloPanel}</strong>
											</h3>
										</div>
										<div class="panel-body">

											<div class="row">

												<div class="col-sm-4 col-md-3" align="center">
													<div class="panel panel-primary">
														<div class="panel-heading">
															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>Datos del Pedido</strong>
															</h3>
														</div>

														<h:panelGrid columns="3">

															<h:outputLabel value="Orden Compra" for="ordenIDProcesar"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />
															<p:inputText id="ordenIDProcesar" styleClass="form-control"
																size="30" disabled="true"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}"
																value="OC-#{ordenCompraController.newOrdenCompra.id}">
															</p:inputText>
															<p:message for="ordenIDProcesar"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />


															<h:outputLabel for="almacenIIDProcesar" value="Almacen" />

															<h:selectOneMenu id="almacenIIDProcesar"
																value="#{ordenCompraController.newOrdenCompra.almacen.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un Almacen!"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va"
																	value="#{ordenCompraController.listAlmacen}"
																	itemValue="#{va.id}" itemLabel="#{va.nombre}" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="almacenIIDProcesar" />

															<h:outputLabel value="Proveedor:" for="proveedorIDProcesar" />
															<h:selectOneMenu id="proveedorIDProcesar"
																value="#{ordenCompraController.newOrdenCompra.proveedor.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un proveedor!"
																disabled="true">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va" value="#{ordenCompraController.listProveedor}"
																	 itemLabel="#{va.nombre}" itemValue="#{va.id}"/>
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="proveedorID" />			

															<h:outputLabel value="Concepto" for="descripcionIDProcesar" />
															<p:inputText id="descripcionIDProcesar" styleClass="form-control"
																size="30"
																disabled="true"
																value="#{ordenCompraController.newOrdenCompra.observacion}">
																<p:ajax event="change" />
															</p:inputText>
															<p:message for="descripcionIDProcesar" />														

															<h:outputLabel for="documentoIDProcesar" value="Tipo_Documento" />
															<h:selectOneMenu id="documentoIDProcesar"
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Requerido."
																disabled="true">
																<f:selectItem itemValue="NA" itemLabel="Sin Documento" />
																<f:selectItem itemValue="FACTURA" itemLabel="Factura" />
																<f:selectItem itemValue="PROFORMA" itemLabel="Proforma" />
																<f:selectItem itemValue="RECIBO" itemLabel="Recibo" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="documentoIDProcesar" />                                                             
                                                            
															<p:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															<p:inputText id="facturaIDProcesar" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"
																disabled="true"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
																<f:validateRegex pattern="[0-9 ]*" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</p:inputText>
															<p:message for="facturaIDProcesar" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															
															<p:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>
															<p:inputText id="conceptoProcesarID" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"
																disabled="#{ordenCompraController.newOrdenCompra.estado=='PR'}"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
															
															</p:inputText>
															<p:message for="conceptoProcesarID" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>

															<h:outputLabel value="Descuento" for="desUNOGIDProcesar" />
															<p:inputText id="desUNOGIDProcesar" styleClass="form-control"
																size="30" disabled="true" converter="converterPorcentaje"
																value="#{ordenCompraController.newOrdenCompra.totalDescuento}"
																required="true" requiredMessage="Requerido.">
																<f:convertNumber type="percent" />
																<p:ajax event="change" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
																<p:ajax event="keyup" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
															</p:inputText>
															<p:message for="desUNOGIDProcesar" />
															
															<h:outputLabel value="Total Bs" for="totalBSIDProcesar" />
															<p:inputText id="totalBSIDProcesar" styleClass="form-control"
																disabled="true" size="30"
																value="#{ordenCompraController.newOrdenCompra.totalImporte}"
																required="true" requiredMessage="Requerido.">
																<p:ajax event="change" />
																<f:convertNumber pattern="#,##0.000"  locale="en" />
															</p:inputText>
															<p:message for="totalBSIDProcesar" />
															
															<h:outputLabel value="Fecha_Registro"
																for="fechaRegistroIDProcesar" />
															<p:inputText id="fechaRegistroIDProcesar"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.fechaRegistro}"
																disabled="true" required="true"
																requiredMessage="Requerido.">
																<f:convertDateTime pattern="dd/MM/yyyy" />
															</p:inputText>
															<p:message for="fechaRegistroIDProcesar" />

															<h:outputLabel value="Registro" for="usuarioRegistroIDProcesar" />
															<p:inputText id="usuarioRegistroIDProcesar"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.usuarioRegistro}"
																disabled="true" required="true"
																requiredMessage="Usuario Registro Requerido." />
															<p:message for="usuarioRegistroIDProcesar" />
														</h:panelGrid>
													</div>
												</div>
												<div class="col-sm-5 col-md-9" align="left">
													<div class="panel panel-success">
														<div class="panel-heading">

															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>LISTA DE DETALLE</strong>
															</h3>
														</div>

														<div class="panel panel-default">
															<div class="table-responsive">

																<p:dataTable
																	styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
																	selection="#{ordenCompraController.selectedDetalleOC}"
																	selectionMode="single" rowKey="#{_det}"
																	id="detalleTableIDProcesar" var="_det"
																	emptyMessage="No se encontraron registros."
																	value="#{ordenCompraController.listaDetalleOC}">
																	<p:ajax event="rowSelect"
																		update=":formRegistroPedidoMov"
																		listener="#{ordenCompraController.onRowSelectDetalleClick}" />


																	<p:column headerText="Nombre">
																		<p:outputLabel value="#{_det.producto.nombreProducto}" />
																	</p:column>

																	<p:column headerText="Cantidad">

																		<h:outputText value="#{_det.cantidad}">
																			<f:convertNumber pattern="#,##0.0000"  locale="en" />
																		</h:outputText>
																		<p:outputLabel value="Uds." />
																	</p:column>
																	
																	<p:column headerText="Precio Unitario.">
																		<h:outputText value="#{_det.precioUnitario}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>																	
																	<p:column headerText="Total BS">
																		<h:outputText value="#{_det.total}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>
																	<p:columnGroup type="footer">
																		<p:row>
																			<p:column footerText="Totals: " colspan="5"
																				style="text-align:right" />
																			<p:column>
																				<f:facet name="footer">
																					<h:outputText value="#{ordenCompraController.newOrdenCompra.totalImporte}">
																						<f:convertNumber pattern="#,##0.000"  locale="en" />
																					</h:outputText>
																				</f:facet>
																			</p:column>																			
																			
																		</p:row>
																	</p:columnGroup>

																</p:dataTable>

															</div>

														</div>
													</div>


												</div>
											</div>
										</div>


									</div>
									<div class="btn-group btn-group-sm" style="width: 100%;">
	
										<p:commandButton
											icon="ui-icon-minus"
											action="#{ordenCompraController.updateProcesadas}"
											style="width: 10em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-default btn-md" value="Volver Atras"
											type="submit" immediate="true" />
	
	
										<p:commandButton value="Ver PDF"
											styleClass="btn btn-success btn-md"
											update=":formModalVistaPrevia" oncomplete="PF('dlgVistaPrevia').show()"
											style="width: 16em;" icon="ui-icon-document">
										</p:commandButton>
	
									</div>									
								</ui:fragment>
																
							
								<ui:fragment rendered="#{!ordenCompraController.estadoDetalleProcesar}" id="fragmentProcesarList">
									<div id="newOrdenComprasMessages" class="update" />

									<h:panelGroup
										rendered="#{empty ordenCompraController.listaOrdenCompraProcesadas}">
										<em>No se encontraron registros.</em>
									</h:panelGroup>


									<div class="panel panel-default">
										<!-- Default panel contents -->
										<div class="panel-heading">
											<center>
												<strong>LISTA DE ORDENES PROCESADAS</strong>
											</center>
										</div>

										<!-- Table -->
										<div class="table-responsive">

											<p:dataTable
												styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
												selection="#{ordenCompraController.selectedOrdenCompra}"
												selectionMode="single" rowKey="#{_pedido.id}"
												id="pedidoPrrocesadasTable" var="_pedido"
												value="#{ordenCompraController.listaOrdenCompraProcesadas}"
												rendered="#{not empty ordenCompraController.listaOrdenCompraProcesadas}">

												<p:ajax event="rowSelect" update=":formRegistroPedidoMov"
													listener="#{ordenCompraController.onRowSelectPedidoProcesadoMovClick}" />

												<p:column headerText="ID" width="50">
													<span class="label label-success">OC-#{_pedido.id}</span>
												</p:column>
												<p:column headerText="Descripcion"
													filterBy="#{_pedido.observacion}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.observacion}" />
												</p:column>

												<p:column headerText="Almacén">
													<h:outputText
														value="#{_pedido.almacen.id}"/>													
												</p:column>
												<p:column headerText="Fecha" width="100"
													filterBy="#{_pedido.fechaRegistro}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.fechaRegistro}">
														<f:convertDateTime pattern="dd/MM/yyyy" />
													</h:outputText>
												</p:column>

												<p:column headerText="Total Bs." filterBy="#{_pedido.totalImporte}" width="100"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.totalImporte}" >
														<f:convertNumber pattern="#,##0.000"  locale="en" />
													</h:outputText>
												</p:column>

												<p:column headerText="Estado" width="100">
													<span class="label label-success"><h:outputText
															rendered="#{_pedido.estado=='AC'}" value="Nuevo" /></span>
													<span class="label label-primary"><h:outputText
															rendered="#{_pedido.estado=='PR'}" value="Aprobado" /></span>
													<span class="label label-danger"><h:outputText
															rendered="#{_pedido.estado=='RM'}" value="Anulado" /></span>
												</p:column>

											</p:dataTable>

										</div>
									</div>
								</ui:fragment>

							</div>

							<div id="tabs5-pane3" class="tab-pane #{ordenCompraController.activeAnuladas}">
							    <ui:fragment id="fragmentProcesarDetalleAnuladas" rendered="#{ordenCompraController.estadoDetalleAnular}">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h3 class="panel-title">
												<strong>#{ordenCompraController.tituloPanel}</strong>
											</h3>
										</div>
										<div class="panel-body">

											<div class="row">

												<div class="col-sm-4 col-md-3" align="center">
													<div class="panel panel-primary">
														<div class="panel-heading">
															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>Datos del Pedido</strong>
															</h3>
														</div>

														<h:panelGrid columns="3">

															<h:outputLabel value="Orden Compra" for="ordenIDAnular"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />
															<p:inputText id="ordenIDAnular" styleClass="form-control"
																size="30" disabled="true"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}"
																value="OC-#{ordenCompraController.newOrdenCompra.id}">
															</p:inputText>
															<p:message for="ordenIDAnular"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />


															<h:outputLabel for="almacenIIDAnular" value="Almacen" />

															<h:selectOneMenu id="almacenIIDAnular"
																value="#{ordenCompraController.newOrdenCompra.almacen.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un Almacen!"
																disabled="true">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va"
																	value="#{ordenCompraController.listAlmacen}"
																	itemValue="#{va.id}" itemLabel="#{va.nombre}" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="almacenIIDAnular" />

															<h:outputLabel value="Proveedor:" for="proveedorIDAnular" />
															<h:selectOneMenu id="proveedorIDAnular"
																value="#{ordenCompraController.newOrdenCompra.proveedor.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un proveedor!"
																disabled="true">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va" value="#{ordenCompraController.listProveedor}"
																	 itemLabel="#{va.nombre}" itemValue="#{va.id}"/>
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="proveedorIDAnular" />
															
															<h:outputLabel value="Concepto" for="descripcionIDAnular" />
															<p:inputText id="descripcionIDAnular" styleClass="form-control"
																size="30"
																disabled="true"
																value="#{ordenCompraController.newOrdenCompra.observacion}">
																<p:ajax event="change" />
															</p:inputText>
															<p:message for="descripcionIDAnular" />															

															<h:outputLabel for="documentoIDAnular" value="Tipo_Documento" />
															<h:selectOneMenu id="documentoIDAnular" disable="true"
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Requerido."
																disabled="true">
																<f:selectItem itemValue="NA" itemLabel="Sin Documento" />
																<f:selectItem itemValue="FACTURA" itemLabel="Factura" />
																<f:selectItem itemValue="PROFORMA" itemLabel="Proforma" />
																<f:selectItem itemValue="RECIBO" itemLabel="Recibo" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="documentoIDAnular" />                                                             
                                                            
															<p:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															<p:inputText id="facturaIDAnular" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"
																disabled="true"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
																<f:validateRegex pattern="[0-9 ]*" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</p:inputText>
															<p:message for="facturaIDAnular" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															
															<p:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>
															<p:inputText id="conceptoIDAnular" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"
																disabled="true"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
																
															</p:inputText>
															<p:message for="conceptoIDAnular" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>

															<h:outputLabel value="Descuento " for="desUNOGIDAnular" />
															<p:inputText id="desUNOGIDAnular" styleClass="form-control"
																size="30" disabled="true" converter="converterPorcentaje"
																value="#{ordenCompraController.newOrdenCompra.totalDescuento}"
																required="true" requiredMessage="Requerido.">
																<f:convertNumber type="percent" />
																<p:ajax event="change" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
																<p:ajax event="keyup" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
															</p:inputText>
															<p:message for="desUNOGIDAnular" />
															
															
															<h:outputLabel value="Total Bs" for="totalBSIDAnular" />
															<p:inputText id="totalBSIDAnular" styleClass="form-control"
																disabled="true" size="30"
																value="#{ordenCompraController.newOrdenCompra.total}"
																required="true" requiredMessage="Requerido.">
																<p:ajax event="change" />
																<f:convertNumber pattern="#,##0.000"  locale="en" />
															</p:inputText>
															<p:message for="totalBSIDAnular" />

															<h:outputLabel value="Fecha_Registro"
																for="fechaRegistroIDAnular" />
															<p:inputText id="fechaRegistroIDAnular"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.fechaRegistro}"
																disabled="true" required="true"
																requiredMessage="Requerido.">
																<f:convertDateTime pattern="dd/MM/yyyy" />
															</p:inputText>
															<p:message for="fechaRegistroIDAnular" />

															<h:outputLabel value="Registro" for="usuarioRegistroIDAnular" />
															<p:inputText id="usuarioRegistroIDAnular"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.usuarioRegistro}"
																disabled="true" required="true"
																requiredMessage="Usuario Registro Requerido." />
															<p:message for="usuarioRegistroIDAnular" />
														
														</h:panelGrid>
													</div>
												</div>
												<div class="col-sm-5 col-md-9" align="left">
													<div class="panel panel-success">
														<div class="panel-heading">

															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>LISTA DE DETALLE</strong>
															</h3>
														</div>

														<div class="panel panel-default">
															<div class="table-responsive">

																<p:dataTable
																	styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
																	selection="#{ordenCompraController.selectedDetalleOC}"
																	selectionMode="single" rowKey="#{_det}"
																	id="detalleTableIDAnular" var="_det"
																	emptyMessage="No se encontraron registros de preparados."
																	value="#{ordenCompraController.listaDetalleOC}">
																	<p:ajax event="rowSelect"
																		update=":formRegistroPedidoMov"
																		listener="#{ordenCompraController.onRowSelectDetalleClick}" />


																	<p:column headerText="Nombre">
																		<p:outputLabel value="#{_det.producto.nombreProducto}" />
																	</p:column>

																	<p:column headerText="Cantidad">

																		<h:outputText value="#{_det.cantidad}">
																			<f:convertNumber pattern="#,##0.0000"  locale="en" />
																		</h:outputText>
																		<p:outputLabel value="Uds." />
																	</p:column>
																	
																	<p:column headerText="Precio Unitario">
																		<h:outputText value="#{_det.precioUnitario}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>
																	
																	<p:column headerText="Total BS">
																		<h:outputText value="#{_det.total}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>
																	<p:columnGroup type="footer">
																		<p:row>
																			<p:column footerText="Totals: " colspan="5"
																				style="text-align:right" />
																			<p:column>
																				<f:facet name="footer">
																					<h:outputText value="#{ordenCompraController.newOrdenCompra.totalImporte}">
																						<f:convertNumber pattern="#,##0.000"  locale="en" />
																					</h:outputText>
																				</f:facet>
																			</p:column>																		
																			
																		</p:row>
																	</p:columnGroup>

																</p:dataTable>

															</div>

														</div>
													</div>


												</div>
											</div>
										</div>


									</div>
									<div class="btn-group btn-group-sm" style="width: 100%;">
	
										<p:commandButton
											icon="ui-icon-minus"
											action="#{ordenCompraController.updateAnuladas}"
											style="width: 10em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-default btn-md" value="Volver Atras"
											type="submit" immediate="true" />
	
	
										<p:commandButton value="Ver PDF"
											styleClass="btn btn-success btn-md"
											update=":formModalVistaPrevia" oncomplete="PF('dlgVistaPrevia').show()"
											style="width: 16em;" icon="ui-icon-document">
										</p:commandButton>
	
									</div>									
								</ui:fragment>
								
								<ui:fragment rendered="#{!ordenCompraController.estadoDetalleAnular}">
									<div id="newOrdenComprasMessages" class="update" />

									<h:panelGroup
										rendered="#{empty ordenCompraController.listaOrdenCompraAnuladas}">
										<em>No se encontraron registros.</em>
									</h:panelGroup>


									<div class="panel panel-default">
										<!-- Default panel contents -->
										<div class="panel-heading">
											<center>
												<strong>LISTA DE ORDENES ANULADAS</strong>
											</center>
										</div>

										<!-- Table -->
										<div class="table-responsive">

											<p:dataTable
												styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
												selection="#{ordenCompraController.selectedOrdenCompra}"
												selectionMode="single" rowKey="#{_pedido.id}"
												id="pedidoAnuladasTable" var="_pedido"
												value="#{ordenCompraController.listaOrdenCompraAnuladas}"
												rendered="#{not empty ordenCompraController.listaOrdenCompraAnuladas}">

												<p:ajax event="rowSelect" update=":formRegistroPedidoMov"
													listener="#{ordenCompraController.onRowSelectPedidoAnularMovClick}" />

												<p:column headerText="ID" filterBy="#{_pedido.id}" width="50"
													filterMatchMode="contains">
													<span class="label label-success">OC-#{_pedido.id}</span>
												</p:column>
												<p:column headerText="Descripcion"
													filterBy="#{_pedido.observacion}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.observacion}" />
												</p:column>											

												<p:column headerText="Almacen"
													filterBy="#{_pedido.almacen.nombre}"
													filterMatchMode="contains">
													<h:outputText
														value="#{_pedido.almacen.nombre}"/>
												</p:column>
												<p:column headerText="Fecha" width="100"
													filterBy="#{_pedido.fechaRegistro}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.fechaRegistro}">
														<f:convertDateTime pattern="dd/MM/yyyy" />
													</h:outputText>
												</p:column>

												<p:column headerText="Total Bs." filterBy="#{_pedido.total}" width="100"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.totalImporte}" >
														<f:convertNumber pattern="#,##0.000"  locale="en" />
													</h:outputText>
												</p:column>											

												<p:column headerText="Estado" width="100">
													<span class="label label-success"><h:outputText
															rendered="#{_pedido.estado=='AC'}" value="Nuevo" /></span>
													<span class="label label-primary"><h:outputText
															rendered="#{_pedido.estado=='PR'}" value="Aprobado" /></span>
													<span class="label label-danger"><h:outputText
															rendered="#{_pedido.estado=='RM'}" value="Anulado" /></span>
												</p:column>

											</p:dataTable>

										</div>
									</div>
								</ui:fragment>

							</div>
						
							<div id="tabs5-pane4" class="tab-pane #{ordenCompraController.activeTodas}">
								
								<ui:fragment id="fragmentProcesarDetalleTodas" rendered="#{ordenCompraController.estadoDetalleTodas}">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h3 class="panel-title">
												<strong>#{ordenCompraController.tituloPanel}</strong>
											</h3>
										</div>
										<div class="panel-body">

											<div class="row">

												<div class="col-sm-4 col-md-3" align="center">
													<div class="panel panel-primary">
														<div class="panel-heading">
															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>Datos de la Orden de Compra</strong>
															</h3>
														</div>

														<h:panelGrid columns="3">

															<h:outputLabel value="Orden Compra" for="ordenIDTodas"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />
															<p:inputText id="ordenIDTodas" styleClass="form-control"
																size="30" disabled="true"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}"
																value="OC-#{ordenCompraController.newOrdenCompra.id}">
															</p:inputText>
															<p:message for="ordenIDTodas"
																rendered="#{ordenCompraController.newOrdenCompra.id gt 0}" />


															<h:outputLabel for="almacenIIDTodas" value="Almacen" />

															<h:selectOneMenu id="almacenIIDTodas"
																value="#{ordenCompraController.newOrdenCompra.almacen.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un Almacen!"
																disabled="#{ordenCompraController.newOrdenCompra.estado!='AC'}">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va"
																	value="#{ordenCompraController.listAlmacen}"
																	itemValue="#{va.id}" itemLabel="#{va.nombre}" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="almacenIIDTodas" />

															<h:outputLabel value="Proveedor:" for="proveedorIDTodas" />
															<h:selectOneMenu id="proveedorIDTodas"
																value="#{ordenCompraController.newOrdenCompra.proveedor.id}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Por Favor, Seleccione un proveedor!"
																disabled="#{ordenCompraController.newOrdenCompra.estado!='AC'}">
																<f:selectItem itemValue="" itemLabel="--Seleccione--" />
																<f:selectItems var="va" value="#{ordenCompraController.listProveedor}"
																	 itemLabel="#{va.nombre}" itemValue="#{va.id}"/>
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="proveedorIDTodas" />															
															
															<h:outputLabel value="Concepto" for="descripcionIDTodas" />
															<p:inputText id="descripcionIDTodas" styleClass="form-control"
																size="30"
																disabled="#{ordenCompraController.newOrdenCompra.estado!='AC'}"
																value="#{ordenCompraController.newOrdenCompra.observacion}">
																<p:ajax event="change" />
															</p:inputText>
															<p:message for="descripcionIDTodas" />
														

															<h:outputLabel for="documentoIDTodas" value="Tipo_Documento" />
															<h:selectOneMenu id="documentoIDTodas"
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}"
																styleClass="form-control" effect="fade" required="true"
																requiredMessage="Requerido."
																disabled="#{ordenCompraController.newOrdenCompra.estado!='AC'}">
																<f:selectItem itemValue="NA" itemLabel="Sin Documento" />
																<f:selectItem itemValue="FACTURA" itemLabel="Factura" />
																<f:selectItem itemValue="PROFORMA" itemLabel="Proforma" />
																<f:selectItem itemValue="RECIBO" itemLabel="Recibo" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</h:selectOneMenu>
															<p:message for="documentoIDTodas" />
                                                             
                                                            
															<p:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															<p:inputText id="facturaIDTodas" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"
																disabled="#{ordenCompraController.newOrdenCompra.estado!='AC'}"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
																<f:validateRegex pattern="[0-9 ]*" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</p:inputText>
															<p:message for="facturaIDTodas" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento!='NA'}"/>
															
															<p:outputLabel 
																value="#{ordenCompraController.newOrdenCompra.tipoDocumento}" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>
															<p:inputText id="conceptoIDTodas" styleClass="form-control" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"
																disabled="true"
																size="30" required="true" requiredMessage="Por Favor, Introduzca el Nº de Documento!"
																value="#{ordenCompraController.newOrdenCompra.numeroDocumento}" validatorMessage="Solo se permiten Digitos">
																<f:validateRegex pattern="[0-9 ]*" />
																<p:ajax event="change" update=":formRegistroPedidoMov" />
															</p:inputText>
															<p:message for="conceptoIDTodas" rendered="#{ordenCompraController.newOrdenCompra.tipoDocumento=='NA'}"/>

															<h:outputLabel value="Descuento " for="desUNOGIDTodas" />
															<p:inputText id="desUNOGIDTodas" styleClass="form-control" converter="converterPorcentaje"
																size="30" disabled="#{ordenCompraController.newOrdenCompra.estado!='AC'}"
																value="#{ordenCompraController.newOrdenCompra.totalDescuento}"
																required="true" requiredMessage="Requerido.">
																<f:convertNumber type="percent" />
																<p:ajax event="change" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
																<p:ajax event="keyup" immediate="true"
																update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID" 
																listener="#{ordenCompraController.actualizarOrdenDetalle}"/>
															</p:inputText>
															<p:message for="desUNOGIDTodas" />															
															
															
															<h:outputLabel value="Total Bs" for="totalBSIDTodas" />
															<p:inputText id="totalBSIDTodas" styleClass="form-control"
																disabled="true" size="30"
																value="#{ordenCompraController.newOrdenCompra.totalImporte}"
																required="true" requiredMessage="Requerido.">
																<p:ajax event="change" />
																<f:convertNumber pattern="#,##0.000"  locale="en" />
															</p:inputText>
															<p:message for="totalBSIDTodas" />


															<h:outputLabel value="Fecha_Registro"
																for="fechaRegistroIDTodas" />
															<p:inputText id="fechaRegistroIDTodas"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.fechaRegistro}"
																disabled="true" required="true"
																requiredMessage="Requerido.">
																<f:convertDateTime pattern="dd/MM/yyyy" />
															</p:inputText>
															<p:message for="fechaRegistroIDTodas" />

															<h:outputLabel value="Registro" for="usuarioRegistroIDTodas" />
															<p:inputText id="usuarioRegistroIDTodas"
																styleClass="form-control" size="40"
																value="#{ordenCompraController.newOrdenCompra.usuarioRegistro}"
																disabled="true" required="true"
																requiredMessage="Usuario Registro Requerido." />
															<p:message for="usuarioRegistroIDTodas" />

															

														</h:panelGrid>
													</div>
												</div>
												
												<div class="col-sm-5 col-md-9" align="left">
													<div class="panel panel-success">
														<div class="panel-heading">

															<h3 class="panel-title">
																<span class="icon"> <i aria-hidden="true"
																	class="icon-list"></i>
																</span> <strong>LISTA DE DETALLE</strong>
															</h3>
														</div>

														<div class="panel panel-default">
															<div class="table-responsive">

																<p:dataTable
																	styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
																	selection="#{ordenCompraController.selectedDetalleOC}"
																	selectionMode="single" rowKey="#{_det}"
																	id="detalleTableIDTodas" var="_det"
																	emptyMessage="No se encontraron registros de preparados."
																	value="#{ordenCompraController.listaDetalleOC}">
																	<p:ajax event="rowSelect"
																		update=":formRegistroPedidoMov"
																		listener="#{ordenCompraController.onRowSelectPedidoTodasMovClick}" />


																	<p:column headerText="Nombre">
																		<p:outputLabel value="#{_det.producto.nombreProducto}" />
																	</p:column>

																	<p:column headerText="Cantidad">

																		<h:outputText value="#{_det.cantidad}">
																			<f:convertNumber pattern="#,##0.0000"  locale="en" />
																		</h:outputText>
																		<p:outputLabel value="Uds." />
																	</p:column>
																	
																	<p:column headerText="Precio Unitario.">
																		<h:outputText value="#{_det.precioUnitario}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>
																	
																	<p:column headerText="Total BS">
																		<h:outputText value="#{_det.total}">
																			<f:convertNumber pattern="#,##0.000"  locale="en" />
																		</h:outputText>
																	</p:column>

																	<p:columnGroup type="footer">
																		<p:row>
																			<p:column footerText="Totals: " colspan="5"
																				style="text-align:right" />
																			<p:column>
																				<f:facet name="footer">
																					<h:outputText value="#{ordenCompraController.newOrdenCompra.totalImporte}">
																						<f:convertNumber pattern="#,##0.000"  locale="en" />
																					</h:outputText>
																				</f:facet>
																			</p:column>																			
																		</p:row>
																	</p:columnGroup>


																</p:dataTable>

															</div>

														</div>
														
														<div class="panel-footer" align="right">
															<p:commandButton value="Agregar" id="agregarID2Todas"
																rendered="#{ordenCompraController.newOrdenCompra.estado=='AC'}"
																icon="ui-icon-plus"
																style="width: 90px;"
																styleClass="btn btn-success btn-right"
																update=":formModalDetalleD" immediate="true"
																actionListener="#{ordenCompraController.listarProducto()}" />

															<p:commandButton id="quitarCompuestoID2Todas" value="Quitar"
																update=":formRegistroPedidoMov"
																rendered="#{ordenCompraController.newOrdenCompra.estado=='AC'}"
																actionListener="#{ordenCompraController.eliminarDetalleOrdenCompra()}"
																icon="ui-icon-trash"
																style="width: 90px; text-color: white;"
																styleClass="btn btn-danger" immediate="true" />


														</div>														
													</div>


												</div>
											</div>
										</div>


									</div>
									
									<div class="btn-group btn-group-sm" style="width: 100%;">
	
										<p:commandButton
											icon="ui-icon-minus"
											action="#{ordenCompraController.updateTodas}"
											style="width: 10em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-default btn-md" value="Volver Atras"
											type="submit" immediate="true" />
											
											
										<p:commandButton
											rendered="#{ordenCompraController.newOrdenCompra.estado=='AC'}"
											icon="ui-icon-refresh"
											action="#{ordenCompraController.modificarOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-primary btn-md" value="Modificar"
											type="submit" />
	
										<p:commandButton
											rendered="#{ordenCompraController.newOrdenCompra.estado=='AC'}"
											icon="ui-icon-circle-close"
											action="#{ordenCompraController.procesarOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-info btn-md" value="Procesar"
											type="submit" />
	
										<p:commandButton
											rendered="#{ordenCompraController.newOrdenCompra.estado=='AC'}"
											icon="ui-icon-circle-close"
											action="#{ordenCompraController.eliminarOrdenCompra()}"
											style="width: 8em;" update=":formRegistroPedidoMov"
											styleClass="btn btn-danger btn-md" value="Anular"
											type="submit" />	
	
	
										<p:commandButton value="Ver PDF"
											styleClass="btn btn-success btn-md"
											update=":formModalVistaPrevia" oncomplete="PF('dlgVistaPrevia').show()"
											style="width: 16em;" icon="ui-icon-document">
										</p:commandButton>
	
									</div>									
								</ui:fragment>
<!-- 								lista de todas las ordenes -->
								<ui:fragment
									rendered="#{!ordenCompraController.estadoDetalleTodas}">
									<div id="newOrdenComprasMessages" class="update" />

									<h:panelGroup
										rendered="#{empty ordenCompraController.listaOrdenCompraTodos}">
										<em>No se encontraron registros.</em>
									</h:panelGroup>


									<div class="panel panel-default">
										<!-- Default panel contents -->
										<div class="panel-heading">
											<center>
												<strong>LISTA DE TODAS LAS ORDENES</strong>
											</center>
										</div>

										<!-- Table -->
										<div class="table-responsive">

											<p:dataTable
												styleClass="table table-condensed table-hover table-responsive table-striped table-bordered"
												selection="#{ordenCompraController.selectedOrdenCompra}"
												selectionMode="single" rowKey="#{_pedido.id}"
												id="pedidoAllTable" var="_pedido"
												value="#{ordenCompraController.listaOrdenCompraTodos}"
												rendered="#{not empty ordenCompraController.listaOrdenCompraTodos}">

												<p:ajax event="rowSelect" update=":formRegistroPedidoMov"
													listener="#{ordenCompraController.onRowSelectPedidoTodasMovClick}" />

												<p:column headerText="ID" filterBy="#{_pedido.id}" width="50"
													filterMatchMode="contains">
													<span class="label label-success">OC-#{_pedido.id}</span>
												</p:column>
												<p:column headerText="Descripcion"
													filterBy="#{_pedido.observacion}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.observacion}" />
												</p:column>												

												<p:column headerText="Almacén]"
													filterBy="#{_pedido.almacen.nombre}"
													filterMatchMode="contains">
													<h:outputText
														value="#{_pedido.almacen.nombre}" />													
												</p:column>
												<p:column headerText="Fecha" width="100"
													filterBy="#{_pedido.fechaRegistro}"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.fechaRegistro}">
														<f:convertDateTime pattern="dd/MM/yyyy" />
													</h:outputText>
												</p:column>

												<p:column headerText="Total Bs." filterBy="#{_pedido.total}" width="100"
													filterMatchMode="contains">
													<h:outputText value="#{_pedido.totalImporte}" >
														<f:convertNumber pattern="#,##0.000"  locale="en" />
													</h:outputText>
												</p:column>

												<p:column headerText="Estado" width="100">
													<span class="label label-success"><h:outputText
															rendered="#{_pedido.estado=='AC'}" value="Nuevo" /></span>
													<span class="label label-primary"><h:outputText
															rendered="#{_pedido.estado=='PR'}" value="Aprobado" /></span>
													<span class="label label-danger"><h:outputText
															rendered="#{_pedido.estado=='RM'}" value="Anulado" /></span>
												</p:column>

											</p:dataTable>

										</div>
									</div>
								</ui:fragment>

							</div>
						</div>
					</div>

				</div>
			</h:form>
		</div>


		<p:dialog showEffect="explode"  minimizable="true" maximizable="true"
			widgetVar="dlgPreparado" resizable="true" modal="true"
			position="center"  styleClass="customDialog"
			visible="#{not empty facesContext.maximumSeverity}"
			id="modalPreparado">

			<div class="modal-body">
				<h:form id="formModalDetalleD">
					<div class="col-sm-5 col-md-12" align="left">
						<div class="panel panel-primary">
							<div class="panel-heading">
								<strong>INGRESO DE PRODUCTOSss</strong>
							</div>
							
							<h:panelGrid columns="2" >
					     		<p:outputLabel value="Producto:         "   />									        
						        <p:autoComplete id="productoID" value="#{ordenCompraController.selectedProductoProveedor.id}" completeMethod="#{ordenCompraController.completeSearhProducto}"
						                        var="producto" itemLabel="#{producto.producto.nombreProducto}"  itemValue="#{producto.id}"  forceSelection="true"
						                        size="100">  
						            <p:ajax event="itemSelect" listener="#{ordenCompraController.onRowSelectProductoClick}" update=":formModalDetalleD:detalle"/>
						           					 
						            <p:column style="width: 40%;">
						                <h:outputText value="#{producto.producto.nombreProducto}"  />
						            </p:column>						           
						        </p:autoComplete>
					     	</h:panelGrid>
						   
						   <h:panelGrid columns="2" id="detalle">
						   		<h:panelGrid columns="2">				        
							        <p:outputLabel value="Proveedor:" />
							        <p:inputText id="proveedorID" value="#{ordenCompraController.newOrdenCompra.proveedor.nombre} "
							        disabled="true"  styleClass="form-control" size="30"> 
							        </p:inputText>  
							        							       						
									<h:outputLabel value="Cantidad:" for="cantidadID" />
									<p:inputText id="cantidadID" styleClass="form-control" type="number"
										size="30" value="#{ordenCompraController.selectedDetalleOC.cantidad}" rendered="true"
										requiredMessage="Llenar este campo..." validatorMessage="La cantidad minima es 1!">
										<p:ajax event="change" update=":formModalDetalleD:detalle"
											listener="#{ordenCompraController.calcularCantidad}" />
										<f:validateLongRange minimum="1" />
									</p:inputText>	
											
								</h:panelGrid>	
	
									<h:panelGrid columns="2">	
									    <h:outputLabel  value="Precio Unitario:" for="precioID" />
										<p:inputText id="precioID" styleClass="form-control" size="30"
											value="#{ordenCompraController.selectedDetalleOC.precioUnitario}"
											 >
											<f:convertNumber pattern="#,##0.000"  locale="en" />
										</p:inputText>
													
										<h:outputLabel value="Total Item Bs:" for="totalBSD"/>
										<p:inputText styleClass="form-control" size="30" 
											value="#{ordenCompraController.selectedDetalleOC.total}" id="totalBSD">
											<f:convertNumber pattern="#,##0.000"  locale="en" />
											<p:ajax event="change" update=":formModalDetalleD:detalle"
											listener="#{ordenCompraController.calcularCantidad}" />											
										</p:inputText>
										
										
										
									</h:panelGrid>								
						   </h:panelGrid>

							<div class="panel-footer" style="padding: 1px 1px 1px 1px;">
								<div class="btn-group btn-group-sm" style="width: 100%;">
									<p:commandButton action="#{ordenCompraController.agregarDetalle()}"
										icon="ui-icon-plus" style="width: 100%;"
										update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID,:formRegistroPedidoMov:detalleTableID, :formModalDetalleD:detalle"
										value="Agregar"  oncomplete="PF('dlgPreparado').hide()" />

								</div>
						  </div>
						</div>
					</div>
				</h:form>
			</div>

			<div class="modal-footer">
				<div class="btn-group btn-group-sm">
					<p:commandButton value="Cerrar" style="width: 8em;"
						icon="ui-icon-minus"
						update=":formRegistroPedidoMov:totalBSID,:formRegistroPedidoMov:detalleTableID,:formRegistroPedidoMov:detalleTableID, :formModalDetalleD:detalle" action="#"
						oncomplete="PF('dlgPreparado').hide()" />
				</div>

			</div>

		</p:dialog>

		<!-- VISTA PREVIA REPORTE -->
		<p:dialog showEffect="explode" header="Vista Previa"
			widgetVar="dlgVistaPrevia" resizable="false" modal="true"
			position="center" width="750" styleClass="customDialog"
			visible="#{not empty facesContext.maximumSeverity}"
			id="modalVistaPrevia">

			<h:form id="formModalVistaPrevia">
					<div class="modal-body">
					<p:media player="pdf" value="#{ordenCompraController.URL}"
						width="700px" height="500px" />
					</div>
				
			</h:form>

			<div class="modal-footer">

				<div class="btn-group btn-group-sm">

					<p:commandButton value="Cerrar" style="width: 150px;"
						icon="ui-icon-minus" styleClass="btn btn-default"
						oncomplete="PF('dlgVistaPrevia').hide()" />
				</div>
			</div>
		</p:dialog>
	</ui:define>
	
	<ui:define name="footer">

	</ui:define>

</ui:composition>